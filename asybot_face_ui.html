<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asybot Face Interface - Brain Simulation</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #121212;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
    <script>
        // --- API KONTROL WAJAH ASYBOT (TIDAK BERUBAH) ---
        // Objek ini sekarang siap untuk menerima perintah dari modul lain.
        const AsybotFace = {
            state: 'NEUTRAL',
            lerpFactor: 0.1,
            bounceFactor: 0,
            current: { eyeSize: 0, mouthWidth: 0, mouthHeight: 0 },
            target: { eyeSize: 0, mouthWidth: 0, mouthHeight: 0 },
            init: function() {
                this.current.eyeSize = this.target.eyeSize = width / 15;
                this.current.mouthWidth = this.target.mouthWidth = width / 8;
                this.current.mouthHeight = this.target.mouthHeight = height / 15;
                this.setExpression(this.state, true);
            },
            setExpression: function(newState, immediate = false) {
                if (this.state === newState && !immediate) return;
                this.state = newState;
                console.log("API CALL: setExpression('" + newState + "')");
                switch (this.state) {
                    case 'HAPPY':
                        this.target.eyeSize = width / 14; this.target.mouthWidth = width / 6; this.target.mouthHeight = height / 10;
                        break;
                    case 'SURPRISED':
                        this.target.eyeSize = width / 12; this.target.mouthWidth = width / 12; this.target.mouthHeight = height / 8;
                        break;
                    case 'THINKING':
                        this.target.eyeSize = width / 18; this.target.mouthWidth = width / 7; this.target.mouthHeight = 5;
                        break;
                    default: // NEUTRAL
                        this.target.eyeSize = width / 15; this.target.mouthWidth = width / 8; this.target.mouthHeight = height / 15;
                        break;
                }
                if (immediate) { this.current = {...this.target}; }
            },
            update: function() {
                this.bounceFactor = sin(frameCount * 0.05) * 5;
                this.current.eyeSize = lerp(this.current.eyeSize, this.target.eyeSize, this.lerpFactor);
                this.current.mouthWidth = lerp(this.current.mouthWidth, this.target.mouthWidth, this.lerpFactor);
                this.current.mouthHeight = lerp(this.current.mouthHeight, this.target.mouthHeight, this.lerpFactor);
            },
            draw: function() {
                let eyeY = height / 2 - height / 10;
                fill(255); noStroke();
                ellipse(width / 2 - width / 10, eyeY + this.bounceFactor, this.current.eyeSize, this.current.eyeSize);
                ellipse(width / 2 + width / 10, eyeY + this.bounceFactor, this.current.eyeSize, this.current.eyeSize);
                let mouthY = height / 2 + height / 12;
                stroke(255); strokeWeight(10);
                switch (this.state) {
                    case 'SURPRISED':
                        fill(18, 18, 18);
                        ellipse(width / 2, mouthY + this.current.mouthHeight / 2, this.current.mouthWidth, this.current.mouthHeight);
                        break;
                    case 'THINKING':
                        noFill();
                        let wiggle = sin(frameCount * 0.2) * 5;
                        line(width / 2 - this.current.mouthWidth / 2, mouthY + wiggle, width / 2 + this.current.mouthWidth / 2, mouthY + wiggle);
                        break;
                    default:
                        noFill();
                        arc(width / 2, mouthY, this.current.mouthWidth, this.current.mouthHeight + this.bounceFactor, 0, PI);
                        break;
                }
            }
        };

        // --- SIMULATOR OTAK ASYBOT ---
        // Modul ini bertindak sebagai 'otak' yang mengontrol wajah.
        const AsybotBrainSimulator = {
            // Daftar ekspresi yang mungkin
            expressions: ['NEUTRAL', 'HAPPY', 'THINKING', 'SURPRISED'],
            // Interval perubahan ekspresi dalam milidetik
            changeInterval: 3000, // 3 detik

            start: function() {
                console.log("Brain Simulator Activated.");
                // Set interval untuk mengubah ekspresi secara periodik
                setInterval(() => {
                    // Pilih ekspresi acak dari daftar
                    const randomIndex = Math.floor(Math.random() * this.expressions.length);
                    const randomExpression = this.expressions[randomIndex];

                    // Panggil API wajah untuk mengubah ekspresi
                    AsybotFace.setExpression(randomExpression);
                }, this.changeInterval);
            }
        };

        // --- P5.JS DRIVER ---
        function setup() {
            createCanvas(windowWidth, windowHeight);
            ellipseMode(RADIUS);
            AsybotFace.init(); // Inisialisasi wajah
            AsybotBrainSimulator.start(); // Mulai simulasi otak
        }

        function draw() {
            background("#121212");
            AsybotFace.update();
            AsybotFace.draw();
        }

        function windowResized() {
            resizeCanvas(windowWidth, windowHeight);
            AsybotFace.setExpression(AsybotFace.state, true);
        }
    </script>
</body>
</html>

